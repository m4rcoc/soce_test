#!/bin/bash

# NOTE: This is the default configuration for rugged 8x8 (HPS v21.1.9)

function hsr_reset(){

cat <<-EOF > cmds/${test_function}_dut_config_restore.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp set_net_id $IP_core_name 0
hsr_prp set_proxy_node_forget_time $IP_core_name 60
hsr_prp disable_supervision_frames_vlan $IP_core_name
hsr_prp set_supervision_frames_vid $IP_core_name 1 
hsr_prp set_redbox_lan_id $IP_core_name A
hsr_prp disable_supervision_frames_tag_removal $IP_core_name
hsr_prp enable_supervision_frames_to_interlink $IP_core_name
hsr_prp enable_supervision_frames_transmission $IP_core_name 
statistics reset_all_statistics $IP_core_name
EOF
}

function hsr_reset_pcie_lp(){

cat <<-EOF > cmds/${test_function}_dut_config_restore.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp set_net_id $IP_core_name 0
hsr_prp set_proxy_node_forget_time $IP_core_name 60
hsr_prp disable_supervision_frames_vlan $IP_core_name
hsr_prp set_supervision_frames_vid $IP_core_name 1 
hsr_prp set_redbox_lan_id $IP_core_name A
hsr_prp disable_supervision_frames_tag_removal $IP_core_name
hsr_prp enable_supervision_frames_to_interlink $IP_core_name
hsr_prp enable_supervision_frames_transmission $IP_core_name 
hsr_prp disable_redundant_ports $IP_core_name
statistics reset_all_statistics $IP_core_name
EOF
}

function hsr_basic(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp clear_proxy_table $IP_core_name
statistics reset_all_statistics $IP_core_name
EOF
}

function hsr_basic_pcie_lp(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp enable_redundant_ports $IP_core_name
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp clear_proxy_table $IP_core_name
statistics reset_all_statistics $IP_core_name
EOF
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.1 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_1_1(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp clear_proxy_table $IP_core_name
EOF
}

function test_hsr_1_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_1_1_restore(){
    hsr_reset
}

function test_hsr_1_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


function test_hsr_1_2(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp enable_supervision_frames_vlan $IP_core_name
hsr_prp clear_proxy_table $IP_core_name
EOF
}

function test_hsr_1_2_pcie_lp(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp enable_redundant_ports $IP_core_name
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp enable_supervision_frames_vlan $IP_core_name
hsr_prp clear_proxy_table $IP_core_name
statistics reset_all_statistics $IP_core_name
EOF
}

function test_hsr_1_2_restore(){
    hsr_reset
}

function test_hsr_1_2_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.2 – 
#-----------------------------------------------------------------------------------------------------------------------------------------


function test_hsr_2_1(){
    hsr_basic
}

function test_hsr_2_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_2_1_restore(){
    hsr_reset
}

function test_hsr_2_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.3 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_3_1(){
    hsr_basic
}

function test_hsr_3_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_3_2(){
    hsr_basic
}

function test_hsr_3_2_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_3_3(){
    hsr_basic
}

function test_hsr_3_3_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_3_4(){
    hsr_basic
}

function test_hsr_3_4_pcie_lp(){
    hsr_basic_pcie_lp
}


function test_hsr_3_1_restore(){
    hsr_reset
}

function test_hsr_3_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


function test_hsr_3_2_restore(){
    hsr_reset
}

function test_hsr_3_2_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


function test_hsr_3_3_restore(){
    hsr_reset
}

function test_hsr_3_3_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


function test_hsr_3_4_restore(){
    hsr_reset
}

function test_hsr_3_4_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.4 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_4_1(){
    hsr_basic
}

function test_hsr_4_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_4_2(){
    hsr_basic
}

function test_hsr_4_2_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_4_3(){
    hsr_basic
}

function test_hsr_4_3_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_4_4(){
    hsr_basic
}

function test_hsr_4_4_pcie_lp(){
    hsr_basic_pcie_lp
}


function test_hsr_4_1_restore(){
    hsr_reset
}

function test_hsr_4_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_4_2_restore(){
    hsr_reset
}

function test_hsr_4_2_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_4_3_restore(){
    hsr_reset
}

function test_hsr_4_3_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_4_4_restore(){
    hsr_reset
}

function test_hsr_4_4_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.5 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_5_1(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp set_redundancy_protocol HPS HSR mode-h
hsr_prp set_hsr_mode HPS HSR-SAN
hsr_prp clear_proxy_table HPS
hsr_prp disable_supervision_frames_transmission HPS
ptp_tc disable_p2p SWITCH *
ptp_tc disable_p2p HPS *
statistics reset_all_statistics SWITCH
statistics reset_all_statistics HPS
EOF
}

function test_hsr_5_1_pcie_lp(){

cat <<-EOF > cmds/${test_function}_dut_config.cmd
soce_cli
hsr_prp enable_redundant_ports $IP_core_name
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp clear_proxy_table $IP_core_name
statistics reset_all_statistics $IP_core_name
hsr_prp disable_supervision_frames_transmission $IP_core_name
ptp_tc disable_p2p $IP_core_name *
statistics reset_all_statistics $IP_core_name
EOF
}

function test_hsr_5_1_restore(){
cat <<-EOF > cmds/${test_function}_dut_config_restore.cmd
soce_cli
hsr_prp set_redundancy_protocol HPS HSR mode-h
hsr_prp set_hsr_mode HPS HSR-SAN
hsr_prp set_net_id HPS 0
hsr_prp set_proxy_node_forget_time HPS 60
hsr_prp disable_supervision_frames_vlan HPS
hsr_prp set_supervision_frames_vid HPS 1 
hsr_prp set_redbox_lan_id HPS A
hsr_prp disable_supervision_frames_tag_removal HPS
hsr_prp enable_supervision_frames_to_interlink HPS
hsr_prp enable_supervision_frames_transmission HPS
ptp_tc enable_p2p SWITCH *
ptp_tc enable_p2p HPS *
statistics reset_all_statistics HPS
statistics reset_all_statistics SWITCH
EOF
}

function test_hsr_5_1_restore_pcie_lp(){
cat <<-EOF > cmds/${test_function}_dut_config_restore.cmd
soce_cli
hsr_prp set_redundancy_protocol $IP_core_name HSR mode-h
hsr_prp set_hsr_mode $IP_core_name HSR-SAN
hsr_prp set_net_id $IP_core_name 0
hsr_prp set_proxy_node_forget_time $IP_core_name 60
hsr_prp disable_supervision_frames_vlan $IP_core_name
hsr_prp set_supervision_frames_vid $IP_core_name 1 
hsr_prp set_redbox_lan_id $IP_core_name A
hsr_prp disable_supervision_frames_tag_removal $IP_core_name
hsr_prp enable_supervision_frames_to_interlink $IP_core_name
hsr_prp enable_supervision_frames_transmission $IP_core_name 
hsr_prp disable_redundant_ports $IP_core_name
ptp_tc enable_p2p $IP_core_name *
statistics reset_all_statistics $IP_core_name
EOF
}



function test_hsr_5_2(){
    test_hsr_5_1
}

function test_hsr_5_2_pcie_lp(){
    test_hsr_5_1_pcie_lp
}

function test_hsr_5_2_restore(){
    test_hsr_5_1_restore
}

function test_hsr_5_2_restore_pcie_lp(){
    test_hsr_5_1_restore_pcie_lp
}


function test_hsr_5_3(){
    test_hsr_5_1
}

function test_hsr_5_3_pcie_lp(){
    test_hsr_5_1_pcie_lp
}

function test_hsr_5_3_restore(){
    test_hsr_5_1_restore
}

function test_hsr_5_3_restore_pcie_lp(){
    test_hsr_5_1_restore_pcie_lp
}

function test_hsr_5_4(){
    test_hsr_5_1
}

function test_hsr_5_4_pcie_lp(){
    test_hsr_5_1_pcie_lp
}

function test_hsr_5_4_restore(){
    test_hsr_5_1_restore
}

function test_hsr_5_4_restore_pcie_lp(){
    test_hsr_5_1_restore_pcie_lp
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.6 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_6_1(){
    hsr_basic
}

function test_hsr_6_1_restore(){
    hsr_reset
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.7 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_7_1(){
    hsr_basic
}

function test_hsr_7_1_restore(){
    hsr_reset
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.8 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_8_1(){
    hsr_basic
}

function test_hsr_8_1_restore(){
    hsr_reset
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.9 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_9_1(){
    hsr_basic
}

function test_hsr_9_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_9_1_restore(){
    hsr_reset
}

function test_hsr_9_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.10 – 
#-----------------------------------------------------------------------------------------------------------------------------------------


function test_hsr_10_1(){
    hsr_basic
}

function test_hsr_10_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_10_1_restore(){
    hsr_reset
}

function test_hsr_10_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.11 – 
#-----------------------------------------------------------------------------------------------------------------------------------------


function test_hsr_11_1(){
    hsr_basic
}

function test_hsr_11_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_11_1_restore(){
    hsr_reset
}

function test_hsr_11_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.12 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_12_1(){
    hsr_basic
}

function test_hsr_12_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_12_1_restore(){
    hsr_reset
}

function test_hsr_12_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.13 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_13_1(){
    hsr_basic
}

function test_hsr_13_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_13_1_restore(){
    hsr_reset
}

function test_hsr_13_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_13_2(){
    hsr_basic
}

function test_hsr_13_2_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_13_2_restore(){
    hsr_reset
}

function test_hsr_13_2_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_13_3(){
    hsr_basic
}

function test_hsr_13_3_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_13_3_restore(){
    hsr_reset
}

function test_hsr_13_3_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.14 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_14_1(){
    hsr_basic
}

function test_hsr_14_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_14_1_restore(){
    hsr_reset
}

function test_hsr_14_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}


#-----------------------------------------------------------------------------------------------------------------------------------------
# Test HSR.15 – 
#-----------------------------------------------------------------------------------------------------------------------------------------

function test_hsr_15_1(){
    hsr_basic
}

function test_hsr_15_1_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_15_1_restore(){
    hsr_reset
}

function test_hsr_15_1_restore_pcie_lp(){
    hsr_reset_pcie_lp
}

function test_hsr_15_2(){
    hsr_basic
}

function test_hsr_15_2_pcie_lp(){
    hsr_basic_pcie_lp
}

function test_hsr_15_2_restore(){
    hsr_reset
}

function test_hsr_15_2_restore_pcie_lp(){
    hsr_reset_pcie_lp
}